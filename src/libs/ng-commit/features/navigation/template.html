<tui-input #filter (keyup)="onFilterChanged(filter.value)">Filter</tui-input>

<tui-tree
  *ngFor="let item of ((node$ | async)?.children ?? [])"
  [tuiTreeController]="true"
  [value]="item"
  [content]="content"
  [childrenHandler]="handler"
></tui-tree>

<ng-template #content let-item>
  <ng-container *ngIf="{activeNodeData: activeNodeData$ | async} as $">
    <ng-container *ngIf="item.isLoading">
      <span>Loading...</span>
    </ng-container>
    <ng-container *ngIf="item.value">
      <tui-svg
        *ngIf="item.value.data === $.activeNodeData && item.value.data !== undefined"
        src="tuiIconCheck"
      ></tui-svg>
      <span
        tuiIconButton
        icon=""
        class="tree-item"
        [class.active]="item.value.data === $.activeNodeData && item.value.data !== undefined"
        (click)="onSelect(item.value.data)"
      >
        {{ item.text }}
      </span>
    </ng-container>
    <ng-container *ngIf="item.error">
      <span>Errror! {{item.error.message}}</span></ng-container
    >
    {{ item.text }}
  </ng-container>
</ng-template>
